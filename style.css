/* --- CSS Variables (Design Tokens) --- */
:root {
    --primary-color: #007bff;
    --success-color: #28a745;
    --secondary-color: #6c757d;
    --danger-color: #dc3545;
    --info-color: #17a2b8;
    --body-bg: #f8f9fa;
    --container-bg: #fff;
    --section-bg: #e9ecef;
    --border-color: #ced4da;
    --text-primary: #212529;
    --text-secondary: #495057;
    --text-on-primary: #fff;
    --border-radius-sm: 6px;
    --border-radius-md: 8px;
    --border-radius-lg: 12px;
    --focus-shadow: 0 0 0 0.2rem rgba(0,123,255,.25);
    --container-shadow: 0 4px 25px rgba(0,0,0,0.08);
    --font-family-base: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
}

/* ... All other CSS up to Medication Section is unchanged ... */
body{font-family:var(--font-family-base);background-color:var(--body-bg);color:var(--text-primary);margin:0;padding:20px}.container{max-width:1200px;margin:auto;background:var(--container-bg);padding:25px 30px;border-radius:var(--border-radius-lg);box-shadow:var(--container-shadow)}header h1{text-align:center;color:var(--text-secondary);margin-bottom:25px;font-weight:700}input,select,textarea{padding:12px;border:1px solid var(--border-color);border-radius:var(--border-radius-sm);font-size:16px;font-family:inherit;transition:border-color .2s,box-shadow .2s;box-sizing:border-box;width:100%}textarea{min-height:120px;resize:vertical}input:focus,select:focus,textarea:focus{border-color:var(--primary-color);outline:0;box-shadow:var(--focus-shadow)}.btn{cursor:pointer;border:none;font-weight:500;white-space:nowrap;padding:12px 18px;border-radius:var(--border-radius-sm);color:var(--text-on-primary);transition:opacity .2s}.btn:hover{opacity:.9}.btn-primary{background-color:var(--primary-color)}.btn-success{background-color:var(--success-color)}.btn-secondary{background-color:var(--secondary-color)}.btn-danger{background-color:var(--danger-color)}.btn-info{background-color:var(--info-color)}.patient-management{background-color:var(--section-bg);padding:20px;border-radius:var(--border-radius-md);margin-bottom:30px}.patient-management h2{margin:0 0 15px;color:var(--text-secondary)}.patient-selector-wrapper{display:flex;gap:10px;align-items:center}#patientSelector{flex-grow:1;font-size:18px;padding:14px}#newPatientBtn{padding:14px 20px}#patientForm{margin-top:15px;background-color:var(--body-bg);padding:15px;border-radius:var(--border-radius-sm);border:1px solid var(--border-color);display:grid;grid-template-columns:1fr 1fr;gap:10px}#patientForm.hidden,.main-content-wrapper.hidden{display:none}.patient-form-actions{grid-column:1 / -1;display:flex;gap:10px;margin-top:5px}#savePatientBtn{flex-grow:1}#recordForm h2{color:var(--text-secondary);border-bottom:2px solid var(--section-bg);padding-bottom:8px;margin:0 0 20px}.record-type-selector{display:flex;margin-bottom:15px}.record-type-btn{flex:1;padding:12px;background-color:var(--body-bg);color:var(--text-secondary);border:1px solid var(--border-color);border-left:none;cursor:pointer}.record-type-btn:first-child{border-top-left-radius:var(--border-radius-md);border-bottom-left-radius:var(--border-radius-md);border-left:1px solid var(--border-color)}.record-type-btn:last-child{border-top-right-radius:var(--border-radius-md);border-bottom-right-radius:var(--border-radius-md)}.record-type-btn.active{background-color:var(--primary-color);color:var(--text-on-primary);border-color:var(--primary-color)}.form-content{background-color:var(--container-bg);border:1px solid var(--border-color);border-top:none;padding:20px;border-bottom-left-radius:var(--border-radius-md);border-bottom-right-radius:var(--border-radius-md)}.form-section{display:none;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:15px;align-items:start}.form-section.active{display:grid}.multi-select-container{grid-column:1 / -1}.multi-select-container label{display:block;font-size:14px;color:var(--secondary-color);margin-bottom:8px;font-weight:500}.tags-container{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px;padding:8px;border:1px solid var(--border-color);border-radius:var(--border-radius-sm);min-height:40px;background-color:#fff}.tag{background-color:var(--primary-color);color:var(--text-on-primary);padding:5px 12px;border-radius:16px;font-size:14px;display:inline-flex;align-items:center;gap:8px}.tag-remove-btn{background:rgba(255,255,255,.3);color:#fff;border:none;border-radius:50%;width:18px;height:18px;font-size:12px;line-height:18px;text-align:center;cursor:pointer}.input-with-suggestions{position:relative}.suggestions-list{position:absolute;top:100%;left:0;right:0;background-color:var(--container-bg);border:1px solid var(--border-color);border-top:none;border-radius:0 0 var(--border-radius-sm) var(--border-radius-sm);max-height:200px;overflow-y:auto;z-index:10}.suggestions-list.hidden{display:none}.suggestion-item{padding:10px 12px;cursor:pointer}.suggestion-item:hover{background-color:var(--section-bg)}.suggestion-item.active{background-color:var(--primary-color);color:var(--text-on-primary)}


/* Medication Section */
#medications-list { display: flex; flex-direction: column; gap: 15px; width: 100%; }

.medication-entry {
    display: grid;
    grid-template-columns: minmax(100px, 1fr) auto minmax(100px, 1fr) auto;
    gap: 10px;
    align-items: center;
}
.med-delete-btn { background-color: var(--danger-color); color: white; border-radius: 50%; width: 30px; height: 30px; padding: 0; line-height: 30px; text-align: center; flex-shrink: 0; }
#addMedicationBtn { margin-top: 15px; width: auto; }

/* ✨✨✨ THE FIX IS HERE ✨✨✨ */
/* Override the generic .form-section rule for the medication tab */
#med-fields.form-section {
    display: block;
}


/* ... All other CSS is unchanged ... */
.form-actions{display:flex;gap:15px;margin-top:20px}#clearFormBtn{flex-basis:150px}#addLogBtn{flex-grow:1;font-size:18px}.input-group{display:flex;flex-direction:column;gap:8px}.quick-add-buttons{display:flex;gap:8px}.btn-quick-add{flex-grow:1;padding:8px;font-size:14px;background-color:var(--section-bg);color:var(--text-secondary);border:1px solid var(--border-color)}.records-section{margin-top:40px}.records-section h2{margin-bottom:20px}.table-wrapper{width:100%;overflow-x:auto}table{width:100%;border-collapse:collapse;font-size:15px}th,td{padding:12px;text-align:left;border-bottom:1px solid var(--border-color);vertical-align:middle}th{background-color:var(--body-bg);white-space:nowrap}.delete-btn{background:0 0;color:var(--secondary-color);font-size:20px;border:none;cursor:pointer;padding:0}.delete-btn:hover{color:var(--danger-color)}@media (min-width:768px){.main-content-wrapper{display:grid;grid-template-columns:450px 1fr;gap:30px;align-items:flex-start}.form-wrapper{position:sticky;top:20px}.btn{padding:15px 22px;font-size:18px}input,select,textarea{padding:15px;font-size:18px}#patientSelector{padding:16px}th,td{padding:16px;font-size:16px}.delete-btn{font-size:24px}}